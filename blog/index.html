<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>BZB Studios — Blog</title>
  <meta name="description" content="News feed for releases, liner notes, and organized ideas by Ben Musser.">
  <link rel="canonical" href="/blog/">
  <style>
    :root{ --ink:#111; --bg:#f7f7fb }
    *{box-sizing:border-box}
    body{ margin:0; font:16px/1.6 system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif; background:var(--bg); color:var(--ink); }
    header,main,footer{ width:min(1100px, 95vw); margin:0 auto; padding:1.2rem }
    .mast{ margin:.2rem 0 1rem; display:flex; align-items:center; justify-content:space-between; gap:1rem }
    .mast a.home{ text-decoration:none; color:inherit; font-weight:900; font-size:clamp(20px,4vw,28px) }

    /* Banner */
    .banner{ border-radius:16px; overflow:hidden; box-shadow:0 8px 30px rgba(0,0,0,.15); margin-bottom:1rem }
    .banner img{ width:100%; height:auto; display:block; aspect-ratio:3/1; object-fit:cover }

    h1{ margin:.4rem 0 .3rem; font-size:clamp(26px,5vw,42px) }
    .kicker{ color:#555; margin:0 0 1rem }
    .grid{ display:grid; grid-template-columns: repeat(auto-fill, minmax(300px,1fr)); gap:1rem }
    .card{ background:#fff; border:1px solid #eee; border-radius:14px; overflow:hidden; display:flex; flex-direction:column; box-shadow: 0 2px 12px rgba(0,0,0,.05) }
    .thumb{ aspect-ratio: 16/9; width:100%; background:#ddd; overflow:hidden }
    .thumb img{ width:100%; height:100%; object-fit:cover; display:block }
    .pad{ padding:1rem; display:flex; flex-direction:column; gap:.5rem }
    .card h2{ margin:.2rem 0; font-size:1.1rem; line-height:1.25 }
    .meta{ font-size:.9rem; color:#666 }
    .tags{ display:flex; gap:.4rem; flex-wrap:wrap }
    .tag{ font-size:.8rem; background:#eef2ff; border:1px solid #dfe6ff; padding:.15rem .45rem; border-radius:999px }
    .more{ text-decoration:none; color:#0b4dff; font-weight:700; margin-top:.3rem }
    .share{ display:flex; flex-wrap:wrap; gap:.4rem; align-items:center; margin-top:.4rem }
    .share a,.share button{ font:600 12px/1 system-ui; padding:.35rem .55rem; border:1px solid #ddd; background:#fff; border-radius:999px; text-decoration:none; color:#111; }
    .share a:hover,.share button:hover{ background:#f6f6f6 }
    footer{ border-top:1px solid #eee; color:#666; font-size:.9rem; margin-top:1.5rem }
  </style>
</head>
<body>
<header class="mast">
  <a class="home" href="/">← Home</a>
</header>

<!-- Restored banner -->
<section class="banner" aria-label="Site banner">
  <img id="blogBanner" src="/blog/assets/banner.jpg" alt="BZB Studios banner">
</section>

<main>
  <h1>Blog</h1>
  <p class="kicker">News-style feed with thumbnails, links, and quick share.</p>

  <section id="feed" class="grid" aria-live="polite"></section>
</main>

<footer>© <span id="year"></span> Ben Musser</footer>

<script>
  document.getElementById('year').textContent = new Date().getFullYear();

  // Hide banner gracefully if the image fails to load
  const b = document.getElementById('blogBanner');
  b.addEventListener('error', ()=>{ b.closest('.banner').style.display='none'; });

  function makeShareRow(url, title){
    const u = encodeURIComponent(url);
    const t = encodeURIComponent(title);
    return `
      <div class="share">
        <button data-ws="${url}" class="ws">Share</button>
        <a target="_blank" rel="noopener" href="https://twitter.com/intent/tweet?text=${t}&url=${u}">X</a>
        <a target="_blank" rel="noopener" href="https://www.facebook.com/sharer/sharer.php?u=${u}">Facebook</a>
        <a target="_blank" rel="noopener" href="https://www.linkedin.com/sharing/share-offsite/?url=${u}">LinkedIn</a>
        <a target="_blank" rel="noopener" href="https://www.reddit.com/submit?url=${u}&title=${t}">Reddit</a>
        <a target="_blank" rel="noopener" href="https://api.whatsapp.com/send?text=${t}%20${u}">WhatsApp</a>
        <a href="mailto:?subject=${t}&body=${t}%0A${u}">Email</a>
      </div>`;
  }

  async function loadFeed(){
    try{
      const res = await fetch('/blog/posts/posts.json?ts='+Date.now(), {cache:'no-store'});
      const items = await res.json();
      const feed = document.getElementById('feed');
      items.sort((a,b)=> (a.date<b.date?1:-1));
      for(const it of items){
        const url = '/blog/posts/' + it.slug + '/';
        const card = document.createElement('article');
        card.className = 'card';
        const date = new Date(it.date).toLocaleDateString(undefined,{year:'numeric',month:'short',day:'numeric'});
        const hero = it.hero || '/blog/assets/banner.jpg';
        card.innerHTML = `
          <a class="thumb" href="${url}"><img src="${hero}" alt=""></a>
          <div class="pad">
            <h2><a href="${url}">${it.title}</a></h2>
            <div class="meta"><time datetime="${it.date}">${date}</time></div>
            <p>${it.excerpt||''}</p>
            <div class="tags">${(it.tags||[]).map(t=>`<span class="tag">${t}</span>`).join('')}</div>
            <a class="more" href="${url}">Read more →</a>
            ${makeShareRow(url, it.title)}
          </div>
        `;
        feed.appendChild(card);
      }
      document.querySelectorAll('.share .ws').forEach(btn=>{
        btn.addEventListener('click', async ()=>{
          const url = btn.getAttribute('data-ws');
          const title = btn.closest('.pad').querySelector('h2').innerText.trim();
          if(navigator.share){
            try{ await navigator.share({title, url}); } catch{}
          }else{
            window.open('https://twitter.com/intent/tweet?text='+encodeURIComponent(title)+'&url='+encodeURIComponent(url),'_blank','noopener');
          }
        });
      });
    }catch(e){
      document.getElementById('feed').innerHTML = '<p>Feed unavailable.</p>';
    }
  }
  loadFeed();
</script>
</body>
</html>
